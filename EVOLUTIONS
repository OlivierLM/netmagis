Proposition d'évolutions de l'application WebDNS

Ce document a pour but de présenter les évolutions prévues de
l'application WebDNS (qui regroupe également les actuelles applications
topo et mac) dans les prochaines semaines et de prioriser ces
évolutions.

1- Recherche d'adresses IP disponibles dans un sous-réseau

    Cette option est accessible à partir de plusieurs pages :
	- page d'ajout de machine
		https://www-crc.u-strasbg.fr/applis/devdns/bin/ajout
	    section "Recherche de plusieurs adresses IPv4 disponibles"
		Option [Rechercher] : permet de sélectionner une
		    plage de N adresses consécutives et d'effectuer
		    l'ajout des N machines
		Option [Consulter la carte] : affiche une carte du
		    sous-réseau colorisée suivant le statut des
		    adresses IP
	- page de consultation des réseaux
		https://www-crc.u-strasbg.fr/applis/devdns/bin/consulter
	    Option [Carte des adresses] : affiche la carte du
		sous-réseau

    À partir de la carte du sous-réseau :
	- cliquer sur une adresse non déclarée permet de déclarer une
	    machine
	- cliquer sur une adresse déclarée permet d'éditer les
	    informations (type de machine, adresse MAC, etc.) ou
	    de supprimer la machine

    Statut :
	- codage effectué, installé dans l'appli de test (cf url de type devdns)
	- en attente de validation/information par l'infra et la GP

2- Affichage de l'adresse IP courante

    Cette option est accessible depuis le bandeau de gauche
    de WebDNS (lien "Où suis-je ?")
	https://www-crc.u-strasbg.fr/applis/devdns/bin/accueil

    Affichage de l'adresse du client Web
	- si hors Osiris : affichage de l'adresse IP
	- si dans Osiris, et non déclaré : affichage des correspondants
	    responsables du sous-réseau
	- si dans Osiris, et déclaré : affichage du nom et des
	    correspondants responsables du sous-réseau

    Statut :
	- codage effectué, installé dans l'appli de test (cf url de type devdns)
	- en attente de validation/information par l'infra et la GP

3- Ajout du profil DHCP dans la liste des machines d'un sous-réseau

    Page accessible via :
	https://www-crc.u-strasbg.fr/applis/dns/bin/consulter

    Statut :
	- codage effectué, installé dans l'appli de test (cf url de type devdns)
	- en attente de mise en production
	- difficulté = facile

4- Renommage facile d'une machine

    Page accessible via :
	https://www-crc.u-strasbg.fr/applis/dns/bin/modif

    Statut :
	- codage effectué, installé dans l'appli de test (cf url de type devdns)
	- en attente de mise en production
	- difficulté = facile

5- Modification des ports d'un équipement

    Il est proposé une interface Web partant de l'actuel topo
	https://www-crc.u-strasbg.fr/applis/topo/bin/eq
    permettant à partir de la page d'un équipement, de sélectionner
    une ou plusieurs interfaces pour modifier :
	- sa description
	- le vlan d'accès
	- le vlan VoIP

    Cette application permettra de configurer une interface sous les
    conditions suivantes :
	- l'interface sert à connecter un équipement terminal (PC
	    et/ou téléphone) et non un équipement réseau. Il n'est
	    donc pas question de modifier les liens d'interconnexion
	    du réseau.
	- le vlan demandé doit être présent sur l'équipement
	    [pour mémoire, il vaut mieux que tous les vlans aient été
	    provisionnés sur les équipements, suivant les décisions
	    prises lors de la réunion du 14/09/2010
	       https://di.u-strasbg.fr/infra/outils-exploit-reseau/topo/cr14092010
	    ]
	- l'application sera ouverte aux correspondants réseau
	- les droits d'accès sur les vlans sont déduits des droits
	    d'accès sur les sous-réseaux IP associés (modèle de
	    droits de topo dérivé de WebDNS)

    Mécanisme :
	- les modifications sont décrites dans la base de données
	- un démon vérifie périodiquement (< 5 min) les demandes
	    de modification, les envoie vers les équipements, et
	    reconstruit le graphe de la topologie
	- la reconstruction du graphe est une opération lente
	    (environ 2 minutes à ce jour sur la machine crc qui est
	    très chargée)
	- l'affichage des interfaces d'un équipement sera complété
	    avec les modifications demandées mais non encore propagées
	    sur l'équipement
	- conclusion : les demandes ne sont pas immédiatement
	    répercutées vers les équipements, une petite latence
	    est à prévoir.

    Maquette d'écrans :

	1- https://www-crc.u-strasbg.fr/applis/topo/bin/eq modifié

	    +----------------------------------------------
	    | Interfaces de xxx-cg1
	    | ...
	    | FastEthernet 0/1 [MODIFIER] (cf 2)
	    |   - vlan xxx ...
	    |	(+ affichage des modifications non encore prises en compte)
	    | FastEthernet 0/2 [MODIFIER] (cf 2)
	    |   - vlan xxx ...
	    |	(+ affichage des modifications non encore prises en compte)
	    |

	2- nouvelle page de modif d'une interface d'un équipement

	    +----------------------------------------------
	    | Modification de l'interface FastEthernet 0/1 de xxx-cg1
	    | ...
	    | [MODIFIER PLUSIEURS INTERFACES] (cf 3)
	    |
	    | Description [               ]
	    | Vlan        [               ]
		(choix simple dans liste des vlans sur l'équipement)
	    | Vlan VoIP   [               ]
		(choix simple dans liste des vlans VoIP sur l'équipement)
	    |
	    | [VALIDER] (propage les modifs)

	3- nouvelle page de modif de plusieurs interfaces

	    +----------------------------------------------
	    | Modification des interfaces de xxx-cg1
	    | ...
	    |
	    | Interfaces  [               ]
		(choix multiple dans la liste des interfaces autorisées)
	    | Vlan        [               ]
		(choix simple dans liste des vlans sur l'équipement)
	    | Vlan VoIP   [               ]
		(choix simple dans liste des vlans VoIP sur l'équipement)
	    |
	    | [VALIDER] (propage les modifs)

    Note : ce point de modification des interfaces des équipements
    nécessite une refonte particulièrement importante de l'infrastructure
    de la topologie.

    Statut :
	- difficulté : très difficile
	- codage effectué à 50 %
	- mise en production du back-office avant fin octobre
	- codage interface Web : mi-novembre

6- Fluidifier la navigation entre les différents composants

    Actuellement, les applications WebDNS, topo et métro, mac, dhcp
    sont des modules séparés et non communicants.

    La proposition consiste à simplifier l'interface utilisateur
    et faciliter la navigation entre ces différents modules.
    Ceci nécessite un changement d'infrastructure important.

    Statut :
	- difficulté : très difficile
	- priorité haute

7- Internationaliser l'application

    Actuellement, tout est rédigé en français. Il faudrait rendre
    l'application utilisable au moins par des anglophones, ce qui
    implique :
	- d'implémenter des mécanismes d'internationalisation (i.e.
	    détection de la langue du client Web)
	- de traduire tous les messages codés en dur dans les scripts
	- de traduire toutes les pages Web
    Dans le futur, il serait bien que tous les commentaires des
    scripts soient rédigés en anglais, afin de faciliter le partage
    du code.

X- Localisation géographique des équipements réseau

    Il s'agit de mettre en correspondance la localisation géographique
    des équipements avec la base Abyla suivant les règles déterminées lors
    de la réunion du 09/09/2010
	https://di.u-strasbg.fr/infra/outils-exploit-reseau/abyla/cr09092010
    et de la réunion du 16/09/2010
	https://di.u-strasbg.fr/archi/abyla-cr20100916

    Ceci permettra des choses importantes :
	- limitation de l'affichage d'un vlan aux équipements d'un
	    bâtiment donné
	- tri/regroupement des équipements par bâtiment
	- représentation cartographique des équipements sur plans
	- etc.

    Actions à faire :
	- saisie dans Abyla de quelques bâtiments de test et dans les
	    configurations des équipements
	- intégration du champ localisation dans le graphe de topo
	- codage de l'incorporation des données Abyla lors de la
	    construction du graphe
	- codage de la récupération des plans Abyla
	- codage de l'interface Web Topo
	- campagne de saisie de tous les bâtiments et de tous les
	    équipements

    Statut :
	- pas encore codé
	- difficulté : moyenne, mais développement important et long
	    (hors saisie des informations dans Abyla et les équipements)

X- Ajout de l'équipement et du numéro de port dans la liste des
    machines d'un sous-réseau

    Page accessible via :
	https://www-crc.u-strasbg.fr/applis/dns/bin/consulter

    Statut :
	- pas encore codé
	- difficulté = facile, mais nécessite convergence WebDNS/Topo/Mac
	    (qui est difficile)

X- Import de machines à partir d'un fichier CSV

    Ce point nécessite de fixer des règles permettant d'assurer la
    cohérence sans contraindre trop l'utilisation. Par exemple :
    ne pas permettre d'ajouter une deuxième adresse à un machine,
    gestion des aliases, etc.

    Statut :
	- nécessite une étude de faisabilité.

X- Pouvoir forcer la mise à jour du DNS

    Implémentation d'un délai raccourci (ex: une minute).

    Statut :
	- pas encore codé
	- difficulté : moyenne à facile

X- Affichage des caractéristiques dynamiques des interfaces d'un équipement

    Ces caractéristiques doivent être interrogées sur l'équipement
    en direct via SNMP :
	- speed		vitesse réelle
	- adminStatus	shutdown ou non
	- operStatus	connecté ou non
	- (cf MIB bridge) adresses MAC derrière ce port

    Statut :
	- nécessite une étude de faisabilité.

X- Affichage du contenu d'un profil DHCP

    Statut :
	- pas encore codé
	- difficulté : facile

X- Création d'un profil DHCP

    Ceci nécessite une validation de la syntaxe du fichier DHCP
    généré sur le serveur Web, soit l'installation d'un serveur
    DHCP (inactif, sauf pour tester les configurations) sur le
    serveur Web. Ceci nécessite également que l'en-tête du fichier
    DHCP soit stocké dans la base de données.

    Statut :
	- pas encore codé
	- difficulté : moyenne

X- Exploitation des logs

    L'application génère des logs des modifications de WebDNS dans
    une table. Pour l'instant, pour lire ces logs, il faut utiliser
    psql et faire des interrogations en SQL.
    La proposition consiste à rendre ces logs visibles par les
    administrateurs de l'applcation dans l'interface Web.

    Statut :
	- pas encore codé
	- difficulté : facile

X- Convergence des logs

    La mise en exploitation de topod, anaconf et la modification
    des ports des équipements génèrent des informations de statut
    qu'il faudrait faire converger avec le log de WebDNS.

    Statut :
	- pas encore codé
	- difficulté : moyenne
